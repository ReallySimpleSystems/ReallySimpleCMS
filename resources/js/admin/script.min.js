/*!
 * Scripts for the admin dashboard.
 * @since 1.5.6-alpha
 *
 * @package ReallySimpleCMS
 */
jQuery(document).ready($=>{'use strict';$('body').on('click','.bulk-selector',function(){let is_checked=$(this).prop('checked');$('.bulk-selector').prop('checked',is_checked);$('.col-bulk-select .checkbox').prop('checked',is_checked)});$('body').on('click','.col-bulk-select .checkbox',function(){let is_checked;$('.col-bulk-select .checkbox').each(function(idx,elem){if(!$(elem).prop('checked')){is_checked=!1;return!1}
is_checked=!0});$('.bulk-selector').prop('checked',is_checked)});$('body').on('click','.bulk-update',function(){let page=$('body').attr('class');let action=$('.bulk-actions .actions').val();let selected=[];let i=0;$('.col-bulk-select .checkbox').each(function(){if($(this).prop('checked')){selected[i]=$(this).val();i++}});if(selected.length>0){$('.content').empty();$('.content').html('<div class="loading">Loading...</div>');$.ajax({data:{page:page,uri:window.location.pathname+window.location.search,action:action,selected:selected},dataType:'html',error:(request,status,error)=>{console.log(error)},method:'POST',success:result=>{$.ajaxPrefilter(function(options,originalOptions,jqXHR){options.async=!0});window.location=window.location.href;$('.content').html(result)},url:'/admin/includes/bulk-actions.php'})}});$('body').on('click','.bulk-delete-spam',function(){$('.content').empty();$('.content').html('<div class="loading">Loading...</div>');$.ajax({data:{page:'comments',uri:window.location.pathname+window.location.search,action:'delete_spam'},dataType:'html',error:(request,status,error)=>{console.log(error)},method:'POST',success:result=>{$.ajaxPrefilter(function(options,originalOptions,jqXHR){options.async=!0});window.location=window.location.href;$('.content').html(result)},url:'/admin/includes/bulk-actions.php'})});(function(){$('.required.init').each(function(){if($(this).val().length>0)$(this).removeClass('invalid');})})();$('.required').on('input',function(){if(!$(this).hasClass('checkbox-label')){$(this).removeClass('init');if($(this).val().length>0){$(this).removeClass('invalid').addClass('valid');if($(this).attr('id')==='password-field')
$('.checkbox-label').removeClass('hidden');}else{$(this).removeClass('valid').addClass('invalid');if($(this).attr('id')==='password-field')
$('.checkbox-label').addClass('hidden');}}});$('.checkbox-input').on('click',function(){if($(this).parent().hasClass('required')){$(this).parent().removeClass('init');if($(this).prop('checked'))
$(this).parent().removeClass('invalid').addClass('valid');else $(this).parent().removeClass('valid').addClass('invalid')}});$('.required').on('blur',function(){$(this).removeClass('init')});$('.submit-input').on('click',function(e){let form=$(this).closest($('.data-form'));if($(form).find('.invalid').length>0){e.preventDefault();$(form).find('.required').removeClass('init')}});$('.checkbox-label.conditional-toggle').each(function(){if(!$(this).children('input').prop('checked'))$(this).siblings('.conditional-field').addClass('hidden');});$('.checkbox-label.conditional-toggle input').on('change',function(){let self=$(this).parent();if($(self).children('input').prop('checked'))
$(self).siblings('.conditional-field').removeClass('hidden');else $(self).siblings('.conditional-field').addClass('hidden')});$('.image-remove').on('click',function(){$(this).parent().siblings('input[data-field="id"]').val(0);$(this).siblings('img[data-field="thumb"]').addClass('greyout')});(function(is_dash){if(is_dash){let max=$('#max-ct').val();$('.bar').each(function(){let count=$(this).text();$(this).css({height:(count/max*100)+'%'})})}})($('body').hasClass('dashboard'));$('#search-toggle').on('click',function(){let form=$('.search-form');$(form).toggleClass('is-visible');if($(form).hasClass('is-visible'))
$('#record-search').focus();});$('.admin-info i').on('click',function(){let wrap=$(this).parent();if($(wrap).hasClass('open'))
$(wrap).removeClass('open');else $(wrap).addClass('open')});$('.notice .dismiss').on('click',function(){$(this).parent().hide(250);let id=$(this).parent().data('id');if(id){let data={'dismiss_notice':!0,'notice_id':id};$.ajax({data:data,method:'POST',success:result=>{console.log(result)},url:'/admin/includes/ajax.php'})}});$('#title-field').on('input',function(){formatSlug(this)});$('#name-field').on('input',function(){formatSlug(this)});$('#slug-field').on('input',function(){let str=$(this).val();str=str.replace(/[^\w\s-]/gi,'');str=str.replace(/[\s-]+/gi,'-');$(this).val(str.toLowerCase())});function formatSlug(field){let str=$(field).val();str=str.trim();str=str.replace(/[^\w\s-]/gi,'');str=str.replace(/[\s-]+/gi,'-');$('#slug-field').val(str.toLowerCase());$('#slug-field').removeClass('init');if($('#slug-field').val().length===0)
$('#slug-field').removeClass('valid').addClass('invalid');else $('#slug-field').removeClass('invalid').addClass('valid')}
$('#select-all').on('click',function(){let list=$(this).parents('.checkbox-list');if($(this).prop('checked')){$(list).find('.checkbox-input').prop('checked',!0);$(this).siblings('span').text('SELECT NONE')}else{$(list).find('.checkbox-input').prop('checked',!1);$(this).siblings('span').text('SELECT ALL')}});(function(){let list=$('.checkbox-list');let all_checked=!1;$(list).find('.checkbox-input').each(function(i){if(i!==0){if($(this).prop('checked')){all_checked=!0;return!1}}});if(all_checked){$('#select-all').prop('checked',!0);$('#select-all').siblings('span').text('SELECT NONE')}})();$('#password-gen').on('click',function(){$('#password-field').val(generatePassword());$('#password-field').removeClass('invalid init').addClass('valid');$('.checkbox-label').removeClass('hidden')});function generatePassword(length=16,special_chars=!0,extra_special_chars=!1){let chars='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';if(special_chars)chars+='!@#$%^&*()';if(extra_special_chars)chars+='-_[]{}<>~`+=,.;:/?|';let password='';for(let i=0;i<parseInt(length);i++){let rand=Math.floor(Math.random()*chars.length);password+=chars.substring(rand,rand+1)}
return password}})